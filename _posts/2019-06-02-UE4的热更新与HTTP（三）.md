## 前言









## temp



生成新版本的md5Table文件， 好久没用Java写 就用Java写一个好了

计算文件的Md5值



``` 

```

```
import com.sun.org.apache.xerces.internal.impl.dv.util.HexBin;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileWriter;
import java.security.MessageDigest;
import java.util.ArrayList;

public class Main {

    /**
     * FileServer底下的所有目录的所有文件全部收集起来。FileServer文件夹下的文件不包括在内
     */
    private static void GetAllFilesFromFolder(File folder, ArrayList<File> result, boolean bIncludeFile){
        for(File file : folder.listFiles()){
            if(file.isFile()){
                if(bIncludeFile){
                    result.add(file);
                }
            }
            if(file.isDirectory()){
                GetAllFilesFromFolder(file, result, true);
            }
        }
    }

    public static void main(String[] args) {
        String Path = "G:\\FileServer";
        int PathLength = Path.length();
        File folder = new File(Path);

        ArrayList<String> output = new ArrayList<>();
        byte[] buffer = new byte[8192];
        ArrayList<File> result = new ArrayList<>();
        GetAllFilesFromFolder(folder, result, false);

        for(File file : result){
            try{
                FileInputStream stream = new FileInputStream(file);
                MessageDigest md = MessageDigest.getInstance("MD5");
                int length;
                while((length = stream.read(buffer)) != -1){
                    md.update(buffer, 0 , length);
                }
                stream.close();
                String relevantPath = file.getAbsolutePath().substring(PathLength + 1);
                String fileMd5 = HexBin.encode(md.digest());
                //文件大小不要超过2GB int32 hold不住
                String line = String.format("%s,%s,%s",relevantPath,fileMd5,file.length());
                output.add(line);
            }
            catch(Exception e){
                e.printStackTrace();
            }
        }
        File outputFile = new File(Path+"\\android_resource_md5.txt");
        try{
            FileWriter outputFileWrite = new FileWriter(outputFile);
            StringBuffer sb = new StringBuffer();
            output.forEach(line->{
                String newLine = line.replaceAll("\\\\","/");
                sb.append(newLine);
                sb.append("\r\n");
            });
            outputFileWrite.write(sb.toString());
            outputFileWrite.close();
        }
        catch(Exception e){
            e.printStackTrace();
        }
    }


}
```